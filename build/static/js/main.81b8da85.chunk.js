(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{160:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),o=n(76),r=n.n(o),i=n(161),u=(n(83),n(11)),c=n(12),m=n(14),l=n(13),h=n(15),p=(n(85),n(23)),f=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(l.a)(t).call(this,e))).state={rooms:[],newRoom:""},n.roomsRef=n.props.firebase.database().ref("rooms"),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.roomsRef.on("child_added",function(t){var n=t.val();n.key=t.key,e.setState({rooms:e.state.rooms.concat(n)})}),this.roomsRef.on("child_removed",function(t){e.setState({rooms:e.state.rooms.filter(function(e){return e.key!==t.key})})})}},{key:"createRoom",value:function(e){this.props.username&&e&&(this.roomsRef.push({name:e}),this.setState({newRoom:""}))}},{key:"deleteRoom",value:function(e){this.roomsRef.child(e.key).remove()}},{key:"handleChange",value:function(e){this.setState({newRoom:e.target.value})}},{key:"render",value:function(){var e=this;return s.a.createElement("section",null,s.a.createElement("h1",null,"Chat Rooms"),s.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.createRoom(e.state.newRoom)}},s.a.createElement("input",{type:"text",value:this.state.newRoom,onChange:function(t){e.handleChange(t)},name:"newRoom"}),s.a.createElement("input",{type:"submit",value:"Add Room"})),s.a.createElement("ul",null,this.state.rooms.map(function(t,n){return s.a.createElement("li",{key:n},s.a.createElement("div",null,s.a.createElement("button",{onClick:function(){return e.props.openRoom(t.key)}},t.name),s.a.createElement("button",{onClick:function(){return e.deleteRoom(t)}},"X")))})))}}]),t}(a.Component),d=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.firebase.auth().onAuthStateChanged(function(t){e.props.createUser(t)})}},{key:"signIn",value:function(){this.props.firebase.auth().signInWithPopup(new this.props.firebase.auth.GoogleAuthProvider)}},{key:"signOut",value:function(){this.props.firebase.auth().signOut()}},{key:"render",value:function(){return s.a.createElement("div",{className:"signin"},s.a.createElement("div",null,this.props.username?this.props.username.displayName:""),s.a.createElement("button",{onClick:this.props.username?this.signOut.bind(this):this.signIn.bind(this)},s.a.createElement("div",null,"Sign ",this.props.username?"out":"in")))}}]),t}(a.Component),v=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(l.a)(t).call(this,e))).state={messages:[],currentMessages:[],username:"",content:"",sentAt:"",newMessage:""},n.messagesRef=n.props.firebase.database().ref("messages"),n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"updateMessages",value:function(e){e&&this.setState({currentMessages:this.state.messages.filter(function(t){return t.roomId===e})})}},{key:"displayTime",value:function(e){var t=e.toString().substring(0,10),n=new Date(1e3*t),a=[n.getHours(),n.getMinutes()],s=a[0]<12?"AM":"PM";a[0]=a[0]<12?a[0]:a[0]-12,a[0]=a[0]||12;for(var o=1;o<3;o++)a[o]<10&&(a[o]="0"+a[o]);return"".concat(a[0],":").concat(a[1]," ").concat(s)}},{key:"componentDidMount",value:function(){var e=this;this.messagesRef.on("child_added",function(t){var n=t.val();n.key=t.key,e.setState({messages:e.state.messages.concat(n)})}),this.messagesRef.on("child_removed",function(t){e.setState({messages:e.state.messages.filter(function(e){return e.key!==t.key})},function(){e.updateMessages(e.props.currentRoom)})})}},{key:"componentWillReceiveProps",value:function(e){var t=e.currentRoom;this.setState({currentMessages:this.state.messages.filter(function(e){return e.roomId===t})})}},{key:"createMessage",value:function(e,t){var n=this;this.messagesRef.push({content:e,roomId:this.props.currentRoom,username:this.props.username?this.props.username.displayName:"Guest",sentAt:this.props.firebase.database.ServerValue.TIMESTAMP},function(){return n.setState({newMessage:"",currentMessages:n.state.messages.filter(function(e){return e.roomId===t})})})}},{key:"handleChange",value:function(e){this.setState({newMessage:e.target.value})}},{key:"deleteMessage",value:function(e){this.messagesRef.child(e.key).remove()}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("h2",null,this.props.currentRoom)),this.state.currentMessages.map(function(t){return s.a.createElement("div",{key:t.key},s.a.createElement("p",null,t.username,":"),s.a.createElement("p",null,t.content),s.a.createElement("p",null,e.displayTime(t.sentAt)),s.a.createElement("button",{onClick:function(){return e.deleteMessage(t)}},"Delete"))}),s.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.createMessage(e.state.newMessage,e.props.currentRoom)}},s.a.createElement("input",{type:"text",value:this.state.newMessage,onChange:function(t){e.handleChange(t)},name:"newMessage"}),s.a.createElement("input",{id:"send",type:"submit",value:"Send"}))))}}]),t}(a.Component);p.initializeApp({apiKey:"AIzaSyBRPeLHabN6YKcnuGD9N5RHgWrGg1zGCE0",authDomain:"chit-chat-8b537.firebaseapp.com",databaseURL:"https://chit-chat-8b537.firebaseio.com",projectId:"chit-chat-8b537",storageBucket:"chit-chat-8b537.appspot.com",messagingSenderId:"45251208663"});var g=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(l.a)(t).call(this,e))).state={currentRoom:"",username:0},n}return Object(h.a)(t,e),Object(c.a)(t,[{key:"createUser",value:function(e){this.setState({username:e})}},{key:"openRoom",value:function(e){this.setState({currentRoom:e})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",null,s.a.createElement(d,{firebase:p,createUser:this.createUser.bind(this),username:this.state.username}),s.a.createElement(f,{firebase:p,currentRoom:this.state.currentRoom,openRoom:function(t){e.openRoom(t)},username:this.state.username}),s.a.createElement(v,{firebase:p,currentRoom:this.state.currentRoom,openRoom:function(t){e.openRoom(t)},username:this.state.username}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(s.a.createElement(i.a,null,s.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},78:function(e,t,n){e.exports=n(160)},83:function(e,t,n){},85:function(e,t,n){}},[[78,2,1]]]);
//# sourceMappingURL=main.81b8da85.chunk.js.map